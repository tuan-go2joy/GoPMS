var Re=Object.defineProperty,Ve=Object.defineProperties;var Ne=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var le=(e,t,o)=>t in e?Re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,O=(e,t)=>{for(var o in t||(t={}))Oe.call(t,o)&&le(e,o,t[o]);if(ae)for(var o of ae(t))Me.call(t,o)&&le(e,o,t[o]);return e},P=(e,t)=>Ve(e,Ne(t));import{Q as Te,a as A,c as E,b as ne}from"./QMenu.23017405.js";import{m as ge,n as k,l as I,p as z,s as Q,w as H,X as $e,W as De,z as Ie,C as be,aM as Le,aN as Be,u as i,aO as ee,aP as we,d as Se,aQ as Ce,o as g,a1 as q,a2 as c,aR as $,aS as V,y as L,a as u,M as j,x as re,a4 as M,t as T,c as Y,r as Pe,aT as se,F as ie,a5 as ue,h as ce,a6 as de}from"./vendor.6afcc2f0.js";import{Q as ze}from"./QTooltip.64e70fed.js";import{Q as Ae}from"./QList.e585812b.js";import{a as te,Q as xe}from"./axiosClient.264e3cda.js";import{T as je}from"./TouchPan.879d8082.js";import{u as Ke,a as Ue,d as ke}from"./useI18n.cd288b87.js";import{u as qe}from"./useNotify.ae0ad5bc.js";import{r as K}from"./index.eca192cd.js";import{u as Fe}from"./useRoomTypeFloorInfoQuery.eae95df3.js";import{u as We}from"./useRoomTypeListQuery.b1ab00a3.js";import{Q as Ye}from"./QSeparator.16660505.js";import{Q as Xe}from"./QTable.db4622a1.js";import{C as fe}from"./ClosePopup.49e1b2a3.js";import{Q as U}from"./queryKeys.553e4145.js";import{_ as Ge}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-prevent-scroll.3abd3655.js";import"./QSelect.4297c779.js";const He=["top","middle","bottom"];var me=ge({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>He.includes(e)}},setup(e,{slots:t}){const o=k(()=>e.align!==void 0?{verticalAlign:e.align}:null),n=k(()=>{const s=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(s!==void 0?` text-${s}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>I("div",{class:n.value,style:o.value,role:"alert","aria-label":e.label},e.label!==void 0?e.label:z(t.default))}}),Je=ge({name:"QSplitter",props:P(O({},Ke),{modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]}),emits:["update:modelValue"],setup(e,{slots:t,emit:o}){const{proxy:{$q:n}}=Ie(),s=Ue(e,n),r=Q(null),f={before:Q(null),after:Q(null)},y=k(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(s.value===!0?" q-splitter--dark":"")),b=k(()=>e.horizontal===!0?"height":"width"),m=k(()=>e.reverse!==!0?"before":"after"),p=k(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function h(a){return(e.unit==="%"?a:Math.round(a))+e.unit}const C=k(()=>({[m.value]:{[b.value]:h(e.modelValue)}}));let w,R,F,N,x;function D(a){if(a.isFirst===!0){const d=r.value.getBoundingClientRect()[b.value];w=e.horizontal===!0?"up":"left",R=e.unit==="%"?100:d,F=Math.min(R,p.value[1],Math.max(p.value[0],e.modelValue)),N=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:n.lang.rtl===!0?-1:1)*(e.unit==="%"?d===0?0:100/d:1),r.value.classList.add("q-splitter--active");return}if(a.isFinal===!0){x!==e.modelValue&&o("update:modelValue",x),r.value.classList.remove("q-splitter--active");return}const l=F+N*(a.direction===w?-1:1)*a.distance[e.horizontal===!0?"y":"x"];x=Math.min(R,p.value[1],Math.max(p.value[0],l)),f[m.value].value.style[b.value]=h(x),e.emitImmediately===!0&&e.modelValue!==x&&o("update:modelValue",x)}const _=k(()=>[[je,D,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function v(a,l){a<l[0]?o("update:modelValue",l[0]):a>l[1]&&o("update:modelValue",l[1])}return H(()=>e.modelValue,a=>{v(a,p.value)}),H(()=>e.limits,()=>{be(()=>{v(e.modelValue,p.value)})}),()=>{const a=[I("div",{ref:f.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:C.value.before},z(t.before)),I("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[$e("div",{class:"q-splitter__separator-area absolute-full"},z(t.separator),"sep",e.disable!==!0,()=>_.value)]),I("div",{ref:f.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:C.value.after},z(t.after))];return I("div",{class:y.value,ref:r},De(t.default,a))}}});function Ze(e){return Le()?(Be(e),!0):!1}const B=typeof window!="undefined",et=e=>typeof e=="string",X=()=>{};function G(e){var t;const o=i(e);return(t=o==null?void 0:o.$el)!=null?t:o}const Ee=B?window:void 0;B&&window.document;B&&window.navigator;B&&window.location;function _e(...e){let t,o,n,s;if(et(e[0])?([o,n,s]=e,t=Ee):[t,o,n,s]=e,!t)return X;let r=X;const f=H(()=>i(t),b=>{r(),!!b&&(b.addEventListener(o,n,s),r=()=>{b.removeEventListener(o,n,s),r=X})},{immediate:!0,flush:"post"}),y=()=>{f(),r()};return Ze(y),y}function tt(e,t,o={}){const{window:n=Ee,ignore:s}=o;if(!n)return;const r=Q(!0),y=[_e(n,"click",m=>{const p=G(e),h=m.composedPath();!p||p===m.target||h.includes(p)||!r.value||s&&s.length>0&&s.some(C=>{const w=G(C);return w&&(m.target===w||h.includes(w))})||t(m)},{passive:!0,capture:!0}),_e(n,"pointerdown",m=>{const p=G(e);r.value=!!p&&!m.composedPath().includes(p)},{passive:!0})];return()=>y.forEach(m=>m())}const J=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Z="__vueuse_ssr_handlers__";J[Z]=J[Z]||{};J[Z];var ve,pe;B&&(window==null?void 0:window.navigator)&&((ve=window==null?void 0:window.navigator)==null?void 0:ve.platform)&&/iP(ad|hone|od)/.test((pe=window==null?void 0:window.navigator)==null?void 0:pe.platform);var ot=Object.defineProperty,ye=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable,he=(e,t,o)=>t in e?ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,nt=(e,t)=>{for(var o in t||(t={}))at.call(t,o)&&he(e,o,t[o]);if(ye)for(var o of ye(t))lt.call(t,o)&&he(e,o,t[o]);return e};const rt={top:0,left:0,bottom:0,right:0,height:0,width:0};nt({text:""},rt);const Qe=e=>{const t=Q(!1),o=Q(null),n=async()=>{var r;t.value=!0,await be(),(r=o.value)==null||r.focus()},s=()=>{t.value=!1,e==null||e.onFinishEdit()};return tt(o,()=>s()),{inputElementRef:o,isEditMode:t,startEdit:n,finishEdit:s}},st=async e=>{const{data:t}=await te.post("/configuration/room/createFloor",e);return t},it=()=>ee(st,{onSuccess:()=>{}}),ut=async e=>{await te.post("/configuration/room/deleteFloor",e)},ct=()=>{const e=we();return ee(ut,{onSuccess:(t,o)=>{const n=e.getQueryData(U.FLOORS);if(!n)return;const{data:s}=n;!s||e.setQueryData(U.FLOORS,()=>P(O({},n),{data:s.filter(r=>r.sn!==o.sn)}))}})},dt=async e=>{const{data:t}=await te.post("/configuration/room/updateFloor",e);return t},ft=()=>{const e=we();return ee(dt,{onSuccess:(t,o)=>{const n=e.getQueryData(U.FLOORS);if(!n)return;const{data:s}=n;!s||e.setQueryData(U.FLOORS,()=>P(O({},n),{data:s.map(r=>r.sn!==o.sn?r:O(O({},r),o))}))}})},mt=Se({props:{floorName:null,floorSn:null,rooms:null},setup(e){const t=e,{data:o}=Fe(),{notifySaveSuccess:n,notifySaveFailed:s,notifyWarning:r}=qe(),f=Ce(),{t:y}=ke(),b=k(()=>{const{code:a}=f.query;return!a||Array.isArray(a)?t.rooms:t.rooms.filter(({roomTypeCode:l})=>l===a.replaceAll("_"," "))}),m=ft(),p=ct(),h=Q(t.floorName),{inputElementRef:C,isEditMode:w,startEdit:R,finishEdit:F}=Qe({onFinishEdit:()=>h.value=t.floorName}),N=[a=>!!a||y("this_is_invalid_value"),a=>a.length<=10||y("this_value_is_too_long"),a=>{var l,d;return!((d=(l=o.value)==null?void 0:l.data)==null?void 0:d.some(({name:S})=>S===a))||y("this_is_invalid_value")}],x=async a=>{var d,S;if((d=C.value)==null||d.validate(),(S=C.value)==null?void 0:S.error)return;const{value:l}=a.currentTarget;m.mutate({sn:t.floorSn,name:l},{onSuccess:()=>{n(),F()},onError:()=>{s()}})},D=()=>{if(t.rooms.length!==0){r(y("please_remove_all_rooms_of_this_floor"));return}p.mutate({sn:t.floorSn},{onSuccess:()=>{n()},onError:()=>{s()}})},_=(a,l)=>{K.replace({path:`/settings/room-settings/rooms/${l.sn}`,state:{roomName:l.name,floorId:t.floorSn},query:f.query})},v=()=>{K.replace({path:"/settings/room-settings/rooms/new",state:{roomName:null,floorId:t.floorSn},query:f.query})};return(a,l)=>(g(),q(Xe,{grid:"",title:t.floorName,rows:i(b),columns:[{name:"room_type_code",label:"Room Type Code",field:d=>d.roomTypeCode},{name:"name",label:"Room Name",field:d=>d.name}],"hide-pagination":"",onRowClick:_},{"top-left":c(()=>[i(w)?(g(),q(xe,{key:0,ref_key:"inputElementRef",ref:C,modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=d=>h.value=d),class:"text-h5",rules:N,placeholder:i(y)("input_floor_name"),filled:"",dense:"",onKeydown:[$(V(x,["prevent"]),["enter"]),$(V(i(F),["prevent"]),["esc"]),$(V(i(F),["prevent"]),["tab"])]},null,8,["modelValue","placeholder","onKeydown"])):(g(),q(L,{key:1,label:t.floorName,class:"text-h5",padding:"xs 12px","no-caps":"",dense:"",flat:"",onClick:i(R)},null,8,["label","onClick"]))]),"top-right":c(()=>[u(L,{flat:"",round:"",icon:"more_vert"},{default:c(()=>[u(Te,{anchor:"bottom right",self:"top right"},{default:c(()=>[j((g(),q(A,{clickable:"",onClick:v},{default:c(()=>[u(E,{side:""},{default:c(()=>[u(re,{name:"add"})]),_:1}),u(E,null,{default:c(()=>[M(T(i(y)("add_new_room")),1)]),_:1})]),_:1})),[[fe]]),u(Ye),j((g(),q(A,{clickable:"",onClick:D},{default:c(()=>[u(E,{side:""},{default:c(()=>[u(re,{name:"delete"})]),_:1}),u(E,null,{default:c(()=>[M(T(i(y)("delete_floor")),1)]),_:1})]),_:1})),[[fe]])]),_:1})]),_:1})]),_:1},8,["title","rows","columns"]))}});const _t={class:"row"},vt={class:"q-my-xl row justify-center"},pt=Se({setup(e){const{data:t}=We(),{data:o,refetch:n}=Fe(),s=it(),r=Ce(),{t:f}=ke(),{notifySaveSuccess:y,notifySaveFailed:b}=qe(),m=Q(""),p=[_=>!!_||f("this_is_invalid_value"),_=>_.length<=10||f("this_value_is_too_long"),_=>{var v,a;return!((a=(v=o.value)==null?void 0:v.data)==null?void 0:a.some(({name:l})=>l===_))||f("this_is_invalid_value")}],{inputElementRef:h,isEditMode:C,finishEdit:w,startEdit:R}=Qe({onFinishEdit:()=>m.value=""}),F=k(()=>{var v,a;let _=0;return(a=(v=t.value)==null?void 0:v.data)==null||a.forEach(({numOfRoom:l})=>_+=l),_}),N=async()=>{var _,v;(_=h.value)==null||_.validate(),!((v=h.value)==null?void 0:v.error)&&s.mutate({name:m.value},{onSuccess:()=>{y(),w(),n.value()},onError:()=>{b()}})},x=()=>{K.replace({path:"/settings/room-settings/room-types/new",query:r.query,state:{code:null}})},D=(_,v)=>{K.replace({path:`/settings/room-settings/room-types/${_}`,query:r.query,state:{code:v}})};return(_,v)=>{const a=Pe("router-view");return g(),Y("div",null,[u(Je,{"model-value":20,"before-class":"q-px-sm","separator-style":"background-color: transparent;"},{before:c(()=>[u(Ae,{separator:"",bordered:"",class:"bg-white"},{default:c(()=>{var l;return[j((g(),q(A,{to:"/settings/room-settings",replace:""},{default:c(()=>[u(E,{class:se([i(r).query.code?"text-black":"text-primary"])},{default:c(()=>[M(T(i(f)("all")),1)]),_:1},8,["class"]),u(E,{side:""},{default:c(()=>[u(me,{label:i(F),rounded:""},null,8,["label"])]),_:1})]),_:1})),[[de]]),(g(!0),Y(ie,null,ue((l=i(t))==null?void 0:l.data,({numOfRoom:d,code:S,name:W,sn:oe})=>j((g(),q(A,{key:oe,to:`/settings/room-settings?code=${S.replaceAll(" ","_")}`,replace:""},{default:c(()=>[u(E,null,{default:c(()=>[u(ne,{class:se([i(r).query.code===S.replaceAll(" ","_")?"text-primary":"text-black","room-type-code--ellipsis"]),style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},{default:c(()=>[M(T(S)+" ",1),u(me,{label:d,rounded:""},null,8,["label"])]),_:2},1032,["class"]),u(ne,{caption:""},{default:c(()=>[M(T(W),1)]),_:2},1024)]),_:2},1024),u(E,{side:""},{default:c(()=>[u(L,{icon:"edit",flat:"",round:"",onClick:V(yt=>D(oe,S),["prevent"])},{default:c(()=>[u(ze,null,{default:c(()=>[M(T(i(f)("edit_room_type")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["to"])),[[de]])),128))]}),_:1}),ce("div",_t,[u(L,{label:i(f)("new_room_type"),class:"col q-my-md bg-orange-9 text-white",icon:"add_circle",stretch:"",onClick:x},null,8,["label"])])]),after:c(()=>{var l;return[(g(!0),Y(ie,null,ue((l=i(o))==null?void 0:l.data,({name:d,sn:S,roomList:W})=>(g(),q(mt,{key:S,"floor-name":d,"floor-sn":S,rooms:W},null,8,["floor-name","floor-sn","rooms"]))),128)),ce("div",vt,[i(C)?(g(),q(xe,{key:0,ref_key:"inputElementRef",ref:h,modelValue:m.value,"onUpdate:modelValue":v[0]||(v[0]=d=>m.value=d),rules:p,class:"h-sm",placeholder:i(f)("input_floor_name"),filled:"",onKeydown:[$(V(N,["prevent"]),["enter"]),$(V(i(w),["prevent"]),["esc"]),$(V(i(w),["prevent"]),["tab"])]},null,8,["modelValue","placeholder","onKeydown"])):(g(),q(L,{key:1,label:i(f)("new_floor"),class:"bg-orange-9 text-white",icon:"add_circle",onClick:i(R)},null,8,["label","onClick"]))])]}),_:1}),u(a)])}}});var Dt=Ge(pt,[["__scopeId","data-v-16bd1e52"]]);export{Dt as default};
