import{j as A,p as P,X as R,P as j,R as q,q as B,l as E,m as V,x as I,M as h,A as Q,ax as M}from"./vendor.c8940223.js";import{f as O}from"./axiosClient.fba0db00.js";var K=A({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(n,{slots:x,emit:d}){const F=I(),u=P(null);let f=0;const r=[];function m(e){const o=[],g=typeof e=="boolean"?e:n.noErrorFocus!==!0;f++;const c=(s,t)=>{d("validation-"+(s===!0?"success":"error"),t)};for(let s=0;s<r.length;s++){const t=r[s],i=t.validate();if(typeof i.then=="function")o.push(i.then(a=>({valid:a,comp:t}),a=>({valid:!1,comp:t,error:a})));else if(i!==!0){if(n.greedy===!1)return c(!1,t),g===!0&&typeof t.focus=="function"&&t.focus(),Promise.resolve(!1);o.push({valid:!1,comp:t})}}if(o.length===0)return c(!0),Promise.resolve(!0);const C=f;return Promise.all(o).then(s=>{if(C===f){const t=s.filter(S=>S.valid!==!0);if(t.length===0)return c(!0),!0;const{valid:i,comp:a}=t[0];return c(!1,a),g===!0&&i!==!0&&typeof a.focus=="function"&&a.focus(),!1}})}function v(){f++,r.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function p(e){e!==void 0&&h(e),m().then(o=>{o===!0&&(n.onSubmit!==void 0?d("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function b(e){e!==void 0&&h(e),d("reset"),Q(()=>{v(),n.autofocus===!0&&n.noResetFocus!==!0&&l()})}function l(){O(()=>{if(u.value===null)return;const e=u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),o=>o.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}R(M,{bindComponent(e){r.push(e)},unbindComponent(e){const o=r.indexOf(e);o>-1&&r.splice(o,1)}});let y=!1;return j(()=>{y=!0}),q(()=>{y===!0&&n.autofocus===!0&&l()}),B(()=>{n.autofocus===!0&&l()}),Object.assign(F.proxy,{validate:m,resetValidation:v,submit:p,reset:b,focus:l,getValidationComponents:()=>r}),()=>E("form",{class:"q-form",ref:u,onSubmit:p,onReset:b},V(x.default))}});export{K as Q};
