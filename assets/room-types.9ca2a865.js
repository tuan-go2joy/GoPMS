var ne=Object.defineProperty,se=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var U=(u,n,a)=>n in u?ne(u,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[n]=a,L=(u,n)=>{for(var a in n||(n={}))ae.call(n,a)&&U(u,a,n[a]);if(I)for(var a of I(n))re.call(n,a)&&U(u,a,n[a]);return u},N=(u,n)=>se(u,ue(n));import{Q as T}from"./QCardSection.c854a72b.js";import{Q as ie}from"./QCard.819f10fc.js";import{a as de}from"./queryKeys.553e4145.js";import{aO as z,d as G,n as J,s as f,aU as me,o as p,a1 as K,a2 as h,u as r,c as O,F as E,a5 as $,a as m,h as g,M as _e,y as j,a3 as fe,aQ as ce,v as pe,t as H,i as ve}from"./vendor.6afcc2f0.js";import{d as W}from"./useI18n.cd288b87.js";import{Q as P}from"./QSkeleton.e2532b07.js";import{a as X,Q as b}from"./axiosClient.264e3cda.js";import{Q as ye}from"./QForm.cdc811d8.js";import{C as be}from"./ClosePopup.49e1b2a3.js";import{u as he}from"./useNotify.ae0ad5bc.js";import{u as Oe}from"./useRoomTypeListQuery.f3301e23.js";import{_ as ge}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-prevent-scroll.3abd3655.js";const Ve=async u=>{const{data:n}=await X.post("/configuration/room/createRoomType",u);return n},Se=()=>z(Ve,{}),Fe=async u=>{const{data:n}=await X.post("/configuration/room/updateRoomType",u);return n},Re=()=>z(Fe,{onSuccess:()=>{}});const we={key:0,class:"wrapper"},Ce={class:"container"},Qe={key:1,class:"wrapper"},ke={class:"container"},Be={class:"q-mt-md row justify-end q-gutter-md"},qe=G({props:{roomTypeSn:null},setup(u){const n=u,{notifySaveSuccess:a,notifySaveFailed:v}=he(),{t:l}=W(),{data:c,isLoading:V,findRoomTypeBySn:_}=Oe(),o=n.roomTypeSn==="new"?null:_(n.roomTypeSn),S=Se(),Y=Re(),k=J(()=>V.value),i=f({numOfAdult:2,numOfChildren:0,numOfBed:1,name:"",code:""});me(()=>{var e,s,t,d,y;i.value={numOfAdult:(e=o==null?void 0:o.numOfRoom)!=null?e:2,numOfChildren:(s=o==null?void 0:o.numOfRoom)!=null?s:0,numOfBed:(t=o==null?void 0:o.numOfRoom)!=null?t:1,name:(d=o==null?void 0:o.name)!=null?d:"",code:(y=o==null?void 0:o.code)!=null?y:""}});const F=f(null),Z=[e=>!!e||l("this_field_is_required"),e=>Number.isInteger(e)||l("this_is_invalid_value"),e=>1<=e||l("this_value_is_too_small"),e=>e<=10||l("this_value_is_too_big")],R=f(null),D=[e=>e==null||l("this_field_is_required"),e=>Number.isInteger(e)||l("this_is_invalid_value"),e=>0<=e||l("this_is_invalid_value"),e=>e<=10||l("this_value_is_too_big")],w=f(null),ee=[e=>!!e||l("this_field_is_required"),e=>Number.isInteger(e)||l("this_is_invalid_value"),e=>1<=e||l("this_value_is_too_small"),e=>e<=10||l("this_value_is_too_big")],C=f(null),le=[e=>!!e||l("this_field_is_required"),e=>e.length<=255||l("this_value_is_too_long"),e=>{var s,t;return!((t=(s=c.value)==null?void 0:s.data)==null?void 0:t.filter(d=>d.sn!==(o==null?void 0:o.sn)).some(d=>d.name===e))||l("this_is_invalid_value")}],Q=f(null),oe=[e=>!!e||l("this_field_is_required"),e=>e.length<=255||l("this_value_is_too_long"),e=>{var s,t;return!((t=(s=c.value)==null?void 0:s.data)==null?void 0:t.filter(d=>d.sn!==(o==null?void 0:o.sn)).some(d=>d.code===e))||l("this_is_invalid_value")}],te=()=>{var e,s,t,d,y,B,q,x,M,A;if((e=F.value)==null||e.validate(),(s=R.value)==null||s.validate(),(t=w.value)==null||t.validate(),(d=C.value)==null||d.validate(),(y=Q.value)==null||y.validate(),!(((B=F.value)==null?void 0:B.error)||((q=R.value)==null?void 0:q.error)||((x=w.value)==null?void 0:x.error)||((M=C.value)==null?void 0:M.error)||((A=Q.value)==null?void 0:A.error))){if(n.roomTypeSn==="new"){S.mutate(i.value,{onSuccess:()=>{a()},onError:()=>{v()}});return}!o||Y.mutate(N(L({},i.value),{sn:n.roomTypeSn}),{onSuccess:()=>{a()},onError:()=>{v()}})}};return(e,s)=>(p(),K(ye,{onSubmit:te},{default:h(()=>[r(k)?(p(),O("div",we,[(p(),O(E,null,$(2,t=>m(P,{key:t,type:"QInput"})),64)),g("div",Ce,[(p(),O(E,null,$(3,t=>m(P,{key:t,class:"col",type:"QInput"})),64))])])):(p(),O("div",Qe,[m(b,{ref_key:"codeField",ref:Q,modelValue:i.value.code,"onUpdate:modelValue":s[0]||(s[0]=t=>i.value.code=t),label:r(l)("room_type_code"),rules:oe},null,8,["modelValue","label"]),m(b,{ref_key:"nameField",ref:C,modelValue:i.value.name,"onUpdate:modelValue":s[1]||(s[1]=t=>i.value.name=t),label:r(l)("room_type_name"),rules:le},null,8,["modelValue","label"]),g("div",ke,[m(b,{ref_key:"numOfBedField",ref:w,modelValue:i.value.numOfBed,"onUpdate:modelValue":s[2]||(s[2]=t=>i.value.numOfBed=t),modelModifiers:{number:!0},label:r(l)("number_of_beds"),rules:ee,class:"col",type:"number"},null,8,["modelValue","label"]),m(b,{ref_key:"numOfAdultField",ref:F,modelValue:i.value.numOfAdult,"onUpdate:modelValue":s[3]||(s[3]=t=>i.value.numOfAdult=t),modelModifiers:{number:!0},label:r(l)("number_of_adults"),rules:Z,class:"col",type:"number"},null,8,["modelValue","label"]),m(b,{ref_key:"numOfChildrenField",ref:R,modelValue:i.value.numOfChildren,"onUpdate:modelValue":s[4]||(s[4]=t=>i.value.numOfChildren=t),modelModifiers:{number:!0},label:r(l)("number_of_children"),rules:D,class:"col",type:"number"},null,8,["modelValue","label"])])])),g("div",Be,[_e(m(j,{label:r(l)("cancel"),flat:"",type:"button"},null,8,["label"]),[[be]]),m(j,{label:r(l)("save"),color:"orange-9",type:"submit",disable:r(k)},null,8,["label","disable"])])]),_:1}))}});var xe=ge(qe,[["__scopeId","data-v-14a8ba80"]]);const Me={class:"text-h6"},Ke=G({setup(u){const n=fe(),a=ce(),{t:v}=W(),l=f(!1),c=J(()=>{const{roomTypeSn:_}=a.params;return Array.isArray(_)?null:_==="new"?"new":typeof+_=="number"?+_:null});pe(()=>l.value=!0);const V=()=>{n.replace({path:"/settings/room-settings",query:a.query})};return(_,o)=>r(c)?(p(),K(de,{key:0,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=S=>l.value=S),onHide:V},{default:h(()=>[m(ie,{style:{width:"700px","max-width":"80vw"}},{default:h(()=>[m(T,null,{default:h(()=>[g("div",Me,H(r(c)==="new"?r(v)("new_room_type"):r(v)("edit_room_type"))+" "+H(r(n).options.history.state.code),1)]),_:1}),m(T,{class:"q-pt-none"},{default:h(()=>[m(xe,{"room-type-sn":r(c)},null,8,["room-type-sn"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):ve("",!0)}});export{Ke as default};
