import{f as B,v as j,W as R,r as L,N,$ as U,o as I,l as u,a0 as P,g as h,j as v,y as l,n as V,x as n,h as H,z,F as Y,a1 as A,C as q,B as d,w as m}from"./vendor.6c1f170c.js";import{a as F,_ as E}from"./index.a42a404f.js";import{d as T}from"./debounce.5c85f6b1.js";import{u as W}from"./useFormat.532d12a0.js";async function G(e){return await F.get("/revenue/getRevenueList",{params:e})}async function J(e){return await F.get("/myBooking/getHotelSearchList",{params:e})}var K={"hotel-list":"_hotel-list_1mg3r_1"};const b=new Date,O=B({name:"Revenue",setup(){const{formatDate:e,formatMoney:s}=W(),{t:C,locale:D}=j(),g=R({isLoadingRevenue:!1,isLoadingHotel:!1,total:0,type:[{label:"page.revenue.check_in_date",value:1},{label:"page.revenue.booking_time",value:2}]}),y=L([]),f=L([]),o=R({hotelSn:"",type:1,page:1,limit:10,startDate:e(new Date(b.getFullYear(),b.getMonth(),1),!1),endDate:e(new Date(b.getFullYear(),b.getMonth()+1,0),!1)}),c=N({get:()=>[o.startDate,o.endDate],set:t=>{o.startDate=t[0],o.endDate=t[1]}});U(()=>c.value,t=>{p()}),I(()=>{p()});const p=async()=>{var t;g.isLoadingRevenue=!0,f.value=[];try{const{data:i}=await G(o);((t=i.data)==null?void 0:t.revenueList.length)>0&&(f.value=i.data.revenueList,f.value.unshift(i.data.statistics)),g.total=i.data.meta.total}catch{return!1}finally{g.isLoadingRevenue=!1}},w=T(function(t){r({limit:10,keyword:t})},500),r=async t=>{g.isLoadingHotel=!0;try{const{data:i}=await J(t);y.value=i.data}catch{return!1}finally{g.isLoadingHotel=!1}};return{t:C,locale:D,ui:g,dataRevenue:f,filter:o,listSuggestionsHotels:y,dateRange:c,formatMoney:s,indexMethod:t=>t==0?"":t,searchSuggestionsHotels:w,listRevenueData:p,handleSizeChange:async t=>{o.limit=t,p()},handleCurrentChange:async t=>{o.page=t,p()}}}});function Q(e,s,C,D,g,y){const f=u("el-option"),o=u("el-select"),c=u("el-form-item"),p=u("el-date-picker"),w=u("el-form"),r=u("el-table-column"),k=u("router-link"),M=u("el-table"),S=u("el-pagination"),t=u("portal-section"),i=P("loading");return h(),v(t,{class:V(e.$style.revenue)},{header:l(()=>[n(w,{inline:!0,model:e.filter,class:"demo-form-inline"},{default:l(()=>[n(c,null,{default:l(()=>[n(o,{modelValue:e.filter.hotelSn,"onUpdate:modelValue":s[0]||(s[0]=a=>e.filter.hotelSn=a),loading:e.ui.isLoadingHotel,placeholder:e.t("page.myBooking.hotelName"),remote:"",filterable:"","remote-method":e.searchSuggestionsHotels,"prefix-icon":"el-icon-search",clearable:"",onChange:e.listRevenueData},{default:l(()=>[(h(!0),H(Y,null,z(e.listSuggestionsHotels,(a,_)=>(h(),v(f,{key:_,label:a.name,value:a.sn,class:V(e.$style["hotel-list"])},{default:l(()=>[m("p",null,d(a.name),1),m("p",null,d(a.address),1)]),_:2},1032,["label","value","class"]))),128))]),_:1},8,["modelValue","loading","placeholder","remote-method","onChange"])]),_:1}),n(c,null,{default:l(()=>[n(p,{modelValue:e.dateRange,"onUpdate:modelValue":s[1]||(s[1]=a=>e.dateRange=a),type:"daterange","range-separator":"-",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",clearable:!1},null,8,["modelValue"])]),_:1}),n(c,null,{default:l(()=>[n(o,{modelValue:e.filter.type,"onUpdate:modelValue":s[2]||(s[2]=a=>e.filter.type=a),onChange:e.listRevenueData},{default:l(()=>[(h(!0),H(Y,null,z(e.ui.type,(a,_)=>(h(),v(f,{key:_,value:a.value,label:e.t(a.label)},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1},8,["model"])]),footer:l(()=>[n(S,{currentPage:e.filter.page,"onUpdate:currentPage":s[3]||(s[3]=a=>e.filter.page=a),"page-sizes":[10,20,30,40,50],"page-size":e.filter.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.ui.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"])]),default:l(()=>[A((h(),v(M,{data:e.dataRevenue},{default:l(()=>[n(r,{"class-name":"break-all",label:"#",type:"index","min-width":"2",index:e.indexMethod},null,8,["index"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.hotel_name"),"min-width":90},{default:l(a=>[n(k,{to:{path:`/revenues-detail/${a.row.hotelSn}`,query:{startDate:e.filter.startDate,endDate:e.filter.endDate}}},{default:l(()=>[q(d(a.row.hotelName),1)]),_:2},1032,["to"]),m("p",null,d(a.row.hotelCode),1)]),_:1},8,["label"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.total_confirmed"),"min-width":90},{default:l(a=>[m("p",null,d(e.formatMoney(a.row.totalConfirmed)),1)]),_:1},8,["label"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.extra_fee"),"min-width":90},{default:l(a=>[m("p",null,d(e.formatMoney(a.row.extraFee)),1)]),_:1},8,["label"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.total_amount"),"min-width":90},{default:l(a=>[m("p",null,d(e.formatMoney(a.row.totalAmount)),1)]),_:1},8,["label"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.discount"),"min-width":90},{default:l(a=>[m("p",null,d(e.formatMoney(a.row.totalHotelDiscount)),1)]),_:1},8,["label"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.user_pay"),"min-width":90},{default:l(a=>[m("p",null,d(e.formatMoney(a.row.amountFromUser)),1)]),_:1},8,["label"]),n(r,{"class-name":"break-all",label:e.t("page.revenue.paid_in_advance"),"min-width":90},{default:l(a=>[m("p",null,d(e.formatMoney(a.row.paidInAdvance)),1)]),_:1},8,["label"])]),_:1},8,["data"])),[[i,e.ui.isLoadingRevenue]])]),_:1},8,["class"])}const $={};$.$style=K;var ae=E(O,[["render",Q],["__cssModules",$]]);export{ae as default};
